.row.wrapper.border-bottom.white-bg.page-heading
  .col-lg-9
    %h2 Gavetão
    %ol.breadcrumb
      %li
        %a{href: main_url} Home
      %li.active
        %strong Gavetão

.wrapper.wrapper-content
  .row
    .col-lg-3
      .ibox.float-e-margins
        .ibox-content
          .file-manager
            %h5 Apresentar
            %a.file-control.active{href: "#"}Todos
            %a.file-control{href: "#"}PDF
            %a.file-control{href: "#"}Word
            %a.file-control{href: "#"}Excel
            %a.file-control{href: "#"}PPT
            %a.file-control{href: "#"}Imagens
            %a.file-control{href: "#"}Áudio (Roll Call)
            %a.file-control{href: "#"}Vídeos
            %a.file-control{href: "#"}Outros
            .hr-line-dashed
            %button.btn.btn-primary.btn-block{"data-target" => "#myModal", "data-toggle" => "modal", :type => "button"}Upload
            .hr-line-dashed
            %h5 Filtros
            .switch
              .onoffswitch
                %input{type: "checkbox", class: "onoffswitch-checkbox", id: "type"}
                  %label{class:"onoffswitch-label", for: "type"}
                    %span.onoffswitch-inner
                    %span.onoffswitch-switch
            %h5.tag-title
              Tags
            %ul.tag-list{style: "padding: 0"}
              - Tag.all.each do |tag|
                %li
                  %a{href: "#"}= tag.name
            .clearfix
            %button.btn.btn-default.btn-block Filtrar
            #myModal.modal.inmodal{"aria-hidden" => "true", :role => "dialog", :tabindex => "-1"}
              .modal-dialog
                .modal-content.animated.bounceInRight
                  .modal-header
                    %button.close{"data-dismiss" => "modal", :type => "button"}
                      %span{"aria-hidden" => "true"} ×
                      %span.sr-only Close
                    %i.fa.fa-cloud-upload.modal-icon
                    %h4.modal-title Upload de arquivo
                  = form_tag({action: :upload}, {multipart: true}) do
                    .modal-body
                      .ibox-content
                        .form-group
                          =file_field_tag 'file',:style => "width:100%",:class =>"btn-file btn-success btn"
                          -if @user.get_role != ExpaPerson.roles[:role_other]
                            %br
                            %label Permissão do arquivo
                            %br
                            %label.control-label{:style => "width:100%;"}
                              .i-checks{:style => "width:50%;float:left;margin-left:auto;margin-right:auto;" }
                                =radio_button_tag "is_private",false
                                =label_tag "Público"
                              .i-checks{:style => "width:50%;float:right;margin-left:auto;margin-right:auto;" }
                                =radio_button_tag  "is_private",true
                                =label_tag "Privado"
                          %label.font-noraml{:style => "width:100%;"} Tags relacionadas ao arquivo
                          .input-group{:style => "width:100%;"}
                            %select.chosen-select{ "name" =>"tags[]", "data-placeholder" => "Escolha pelo menos uma tag para o arquivo", :multiple => "multiple", :style => "width: auto;", :tabindex => "4"}
                              - Tag.all.each do |tag|
                                %option{:value => tag.id}=tag.name
                    .modal-footer
                      =submit_tag "Enviar arquivo", :class =>"btn btn-primary", :onclick => "closeModal()"
    .col-lg-9.animated.fadeInRight
      .row
        .col-lg-12
          - @archives.each do |file|
            -if file.is_deleted && (@user.get_role ==ExpaPerson.roles[:role_mc]|| @user.get_role ==ExpaPerson.roles[:role_eb])
              .file-box{ style: "opacity:0.3;"}
                .file
                  %span.corner
                  .image
                    %img.img-responsive{alt: "image", src: "#{image_path('p1.png')}"}
                  -path =  "/"+file.id.to_s+ "." +file.name.split(".").last
                  .buttons
                    .btn.btn-success
                      %a{href: ($client.shares path)['url'], style: "color:fff;"}
                        %i.fa.fa-eye
                    .btn.btn-success
                      %a{style: "color:fff;"}
                        %i.fa.fa-edit
                    .btn.btn-success
                      %a{href:download(path), style: "color:fff;"}
                        %i.fa.fa-download
                  .file-name
                    = file.name
                    %br
                    %small Adicionado em:
                    = file.created_at.strftime('%dd %bbb %YYYY')
                    %small Adicionado por:
                    = file.person.xp_full_name.split(' ').first
                    %small Entidade:
                    = file.office.xp_name
            -elsif !file.is_deleted
              .file-box
                .file
                  %span.corner
                  .image
                    -if file.type_of_file=='image'
                      %img.img-responsive{alt: "image", src: "#{image_path("thumbnails/thumb_#{file.id.to_s}.jpg")}" }
                    -elsif file.type_of_file=='pdf'
                      %i.fa.fa-file-pdf-o.icon-thumbnail
                  -path =  "/"+file.id.to_s+ "." +file.name.split(".").last
                  .button-section
                    .buttons
                      .btn.btn-success
                        %a{href: ($client.shares path)['url'], style: "color:fff;"}
                          %i.fa.fa-eye
                      .btn.btn-success
                        %a{href:download(path), style: "color:fff;"}
                          %i.fa.fa-download
                      -if (file.is_private==true && (@user.get_role ==ExpaPerson.roles[:role_mc]|| @user.get_role ==ExpaPerson.roles[:role_eb]))|| !file.is_private
                        %button.btn.btn-primary{"data-target" => "#editModal", "data-toggle" => "modal", :type => "button"}
                          %a{href: archives_edit_path(file.id), remote: true, style: "color:fff;"}
                            %i.fa.fa-edit
                        = form_tag({action: :remove}, style: "display:inline;") do
                          = hidden_field_tag(:id, file.id)
                          = button_tag(type: "submit", class: "btn btn-success") do
                            %i.fa.fa-trash
                  .file-name
                    = file.name
                    %br
                    %small Adicionado em:
                    = file.created_at.strftime('%d %b %Y')
                    %br
                    %small Adicionado por:
                    = file.person.xp_full_name.split(' ').first
                    %br
                    %small Entidade:
                    = file.office.xp_name

#edit-modal.modal.fade



:javascript
    $(function() {

      $('.i-checks').iCheck({
          checkboxClass: 'icheckbox_square-green',
          radioClass: 'iradio_square-green',
      });

    });

    $(function() {
      var config = {
          '.chosen-select': {},
          '.chosen-select-deselect': { allow_single_deselect: true },
          '.chosen-select-no-single': { disable_search_threshold: 10 },
          '.chosen-select-no-results': { no_results_text: 'Oops, nothing found!' },
          '.chosen-select-width': { width: "95%" }
      }
      for (var selector in config) {
          $(selector).chosen(config[selector]);
      }
    });
    function closeModal(){
        $('#myModal').modal('hide');
      }
